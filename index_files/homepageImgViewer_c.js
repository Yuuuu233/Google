var ImgViewer=function(){function uu(){var n=_ge("sh_rdiv");n&&(sj_be(n,l,function(){hp_addclass(n,tr)}),sj_be(n,bt,function(){hp_removeclass(n,tr)}))}function fu(){var n=_ge("hp_cellCenter");return n&&n.className.indexOf("hp_hd")!=-1&&typeof g_img!==c&&hp_defined(g_img.hdurl)&&g_img.url==g_img.hdurl?!0:!1}function ur(n,t,i){var r=sj_gx(),e="hp",o=_H.vert?e:"js",f=hp_pushparams(["format="+o,"idx="+n,"n="+t,"nc="+sb_gt(),"pid=hp"]),s,h;_w.g_vidOn&&f.push("video=1");_H.quiz&&f.push("quiz=1");_H.favs&&f.push("fav=1");_H.archiveIID&&_w._G&&_G.IG&&_G.P&&(f.push("IG="+_G.IG),s=_H.archiveIID+n,f.push("IID="+_G.P+"."+s));h="/HPImageArchive.aspx?"+f.join("&");r.open("GET",h,!0);sj_be(r,"readystatechange",function(){var h,f,s,c,t;if(r.readyState==4&&r.status==200){if(o==e){if(s=sj_ce("div"),s.innerHTML=r.responseText,s.children.length<1)return;c=s.getElementsByClassName("json")[0];h=c.textContent;f=s.getElementsByClassName("html")[0]}else h=r.responseText;if(u=eu(h),f&&f.children&&u.images)for(t=0;t<f.children.length&&t<u.images.length;t++)u.images[t].html=f.children[t];rt=Math.min(kt,n+(u&&u.images&&u.images.length)||0);i(!!u)}});r.send(null)}function eu(n){if(typeof n!="string"||!n)return null;if(_w.JSON&&_w.JSON.parse)try{return _w.JSON.parse(n)}catch(t){}try{return new Function("return "+n)()}catch(t){return null}}function ou(){for(var n=0,t=u.images.length;n<t;n++)fi(n,n)}function fi(n,i){var o;if(t[n]=u.images[i]||null,tu){var r=Math.max(screen.height,screen.width),f=Math.min(screen.height,screen.width),e="//"+window.location.host+"/iod/";t[n].url=e+r+"/"+f+"/"+t[n].fullstartdate;t[n].portraiturl=e+f+"/"+r+"/"+t[n].fullstartdate}else ru&&(o="_1920x1080.jpg",t[n].url=t[n].urlbase+o);u.quiz&&(t[n].quiz=u.quiz);u.fav&&(t[n].fav=u.fav)}function fr(i){var r=n+1;ut[r]||r>=kt?at():t[r]?er(r):ur(r,1,function(n){n?(fi(r,0),er(r)):at();typeof i=="function"&&i(n)})}function su(){var n=g_prefetch;n&&(n.Im&&hu(n.Im),n.Vid&&cu(n.Vid))}function hu(n){var t=new Image;t.onload=function(){var t=sj_cook.get("_SS","bIm");t=t&&t.length>=3?t.substring(t.length-3)+n.hash:n.hash;sj_cook.set("_SS","bIm",t,0,"/")};t.src=n[ft]}function cu(n){var t=sj_ce("video","prefVid"),i,u,r;try{t.setAttribute("preload","auto")}catch(f){}for(t.width=956,t.height=512,i=0,u=n.length;i<u;i++)r=sj_ce("source"),r.src=n[i][2],r.type=n[i][1],t.appendChild(r);t.style.display="none";sj_b.appendChild(t);sj_be(t,"canplaythrough",function(){var n=_ge("prefVid");n&&sj_b.removeChild(n)})}function er(n){if(!ut[n]){at();var i=t[n],r=new Image;r.onload=function(){sj_evt.fire("onHPIVImg"+n,n);ut[n]=1};r.src=i.pano?i.pano.image:_w.g_vidOn&&i.vid?i.vid.image:i[ft]}}function lu(){var i=_ge("audioElm"),n,t;i&&i.pause();n=_ge("audioMain");n&&(n.style.display=v);t=_ge("hp_audio_info");t&&(t.style.display=v)}function ei(t){n==0||b||(n--,gt=1,or(),cr(1,n));t&&sj_pd(t)}function oi(t){if(n<rt-1&&!b&&!dt){var i=n+1;gt=1;dt=1;ut[i]||pu();sj_evt.bind("onHPIVImg"+i,yu,1);cr(-1,i)}t&&sj_pd(t)}function au(n){if(vu())n.key=="ArrowLeft"||n.keyCode==37?(yr(n),_w.Log&&Log.Log&&Log.Log("Show","HP","ArrowLeft",!1)):(n.key=="ArrowRight"||n.keyCode==39)&&(pr(n),_w.Log&&Log.Log&&Log.Log("Show","HP","ArrowRight",!1))}function vu(){var n=_ge("sb_form_q");return!(n&&n.value&&n.value!=="")}function yu(t){t[1]==n+1&&(n++,dt=0,or())}function at(){var r=t[n],u=r[nr]=="1"?et:ot,e,s,h,l;r.vid&&(e=r.vid.dark,_ge("sh_pl").parentNode.className=e?"sh_pll":"sh_pld",_ge("sh_ps").parentNode.className=e?"sh_psl":"sh_psd",u=e?et:ot);s=u+"dis";a&&(a.className=u,h=a.href===st?wt:pt,a.style.cursor=h);n===rt-1?(i.firstChild.className=s,hp_disable(i)):(i.firstChild.className=u,hp_enable(i));n==0?(f.firstChild.className=s,hp_disable(f)):(f.firstChild.className=u,hp_enable(f));i.title=k.previous;f.title=k.next;l=gt?"nav":"";sj_evt.fire("updateHpImg",r,l);o&&typeof hpWall!==c&&(r.wp&&!r.vid?(hpWall.enabled=!0,hpWall.hash=r.hsh,o.firstChild.className=u,o.title=k.walls,o.style.cursor=pt):(hpWall.hash="",hpWall.enabled=!1,hpWall.tB(0),o.firstChild.className=s,o.title=k.walle,o.style.cursor=wt))}function pu(){i.title=k.loading}function or(){var t,i,u;if(b=1,ii&&clearTimeout(ii),fr(),w&&w.disable(),t=_ge("vid"),_w.g_vidOn&&(VM.InFoc=0,t&&t.style.opacity!="0"&&(t.onended=null,VM.hideControls())),_ge("sh_iga")&&lu(),r&&r.style.opacity!="0"){_ge("panoControls").style.visibility=pi;e.style.backgroundImage="url()";i=_ge("sh_pps");u=_ge("sh_ppl");i&&u&&(i.style.display=v,i.tabIndex="-1",u.style.display=v,u.tabIndex="-1");ht.down(function(){e.removeChild(r);ht=r=null;ni[n]||sr()});return}ni[n]?b=0:ri.down(sr)}function sr(){var s;e.style.display=v;var i=t[n],r=_ge("vid"),f=_ge("sc_mktb"),o=t[n].fullstartdate,h=o.substr(0,8)+"_"+o.substr(8,4),u;if(r&&_w.g_vidOn&&VM&&(r.pause&&!r.paused&&r.pause(),r.style.display="none",sj_so(r,0),VM.Loaded=!1,_w.g_vid=null,i.vid)){if(si(i.vid.caption,i.copyrightlink),u="url('"+i.vid.image+"')",e.style.backgroundImage=u,e.style.display=di,i.vid.loop){r.onended=VM.play;try{r.setAttribute("loop","true")}catch(c){}}else{r.onended=VM.end;try{r.removeAttribute("loop")}catch(c){}}_w.g_vid=i.vid.sources;VM.InFoc=1;VM.sa_vid_ld(wu);ri.up(hr)}i.pano&&hi(i.pano,!1);i.vid||(si(i.copyright,i.copyrightlink),u=i[ft],i.pano&&(u=i.pano.image),u="url('"+u+"')",e.style.backgroundImage=u,e.style.filter=sb_i8l?"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i[ft]+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity=0);":"",e.style.display=di,ri.up(hr));sj_evt.fire("onHPImgViewerNavigation",h);sj_evt.fire("CurImageIdx",n);f&&(s=_ge("hp_husb"),f.style.display=!!s||i.vid||i.pano?"none":"block")}function si(n,t){var i=typeof t==c||t==""||t==st,r=_ge("musCard");a&&(r?a.href=st:(a.title=n,a.href=i?st:t,a.style.cursor=i?wt:pt))}function wu(){var n=_ge("vid");n&&VM&&VM.InFoc&&(VM._autoPlay===!1?VM.pause():VM.play(),VM.Loaded=!0,n.style.display="block",sj_so(n,100))}function hr(){var f,o,l,r,a,s,v,p,i,e,u,h;if(b=0,f=t[n],_w.g_hot&&(!f.pano||f.pano.hs===!0)){for(o=f.hs,i=0,h=o.length;i<h;i++){if(i>=o.length){typeof g_triggerElems!==c&&(g_triggerElems[i].isHotSpotDisabled=!0);continue}else typeof g_triggerElems!==c&&(g_triggerElems[i].isHotSpotDisabled=!1);l=i+1;r=o[i];a=_ge("sc_hst"+l);a.style.left=r.locx+"%";a.style.top=r.locy+"%";s=_ge("sc_hs"+l);s.href=r.link;s.firstChild.innerHTML=r.desc;s.firstChild.nextSibling.innerHTML=r.query}w&&w.intro(1)}var k=_ge("hp_pgNav"),d=k?2:0,y=_ge("hp_pgbar");if(y)for(v=y.getElementsByTagName("h3"),p=f.msg,i=0,h=v.length;i<h;i++){if(e=p[i],!e)break;if(u=v[i+d],!u)break;u.parentNode.id!==dr&&(u.innerHTML=e.title,u.nextSibling.innerHTML=e.text,u.nextSibling.href=e.link)}}function cr(n){if(typeof hpl!==c){if(hpl&&(p=hpl),p&&p.ssd){var t=p.ssd,i=new Date(parseInt(t.substr(0,4),10),t.substr(4,2)-1,parseInt(t.substr(6,2),10)+n);p.ssd=i.getFullYear().toString()+lr(i.getMonth()+1)+lr(i.getDate())+"_"+t.substr(9,4)}p&&(hpl=p)}}function lr(n){return(n<10?"0":"")+n}function bu(n){var t,u,i;if(si(n.cap,n.caplink),n.spots)for(t=0,u=n.spots.length;t<u;t++)i=n.spots[t],Pano.CreateHotspot(i[0],i[1],i[2]);b=1;r.style.opacity=0;e.style.opacity=1;r.style.visibility=g;ht.up(function(){var t,i,r,u,f,e;_ge("panoControls").style.visibility=g;t="hpVideoPause";sj_evt.bind(ki,function(){Pano.StopAnimation()});i=!0;n.an===!0&&(r=sj_cook&&sj_cook.get("SRCHHPGUSR","HAP"),r&&r!="0"&&(i=!1),_w.g_hpLocal&&(u=localStorage.getItemE(t),u!=null&&u===1&&(i=!1)),i?ii=sb_st(function(){Pano.IdleAnimate()},500):Pano.StopAnimation());f=_ge("panoPause");e=_ge("panoPlay");f&&e&&(sj_be(f,l,function(){_w.g_hpLocal&&localStorage.setItemE(t,1,1440);Pano.StopAnimation()}),sj_be(e,l,function(){_w.g_hpLocal&&localStorage.removeItem(t);Pano.IdleAnimate(!0)}));b=0})}function s(n){return sj_ce(nu,n)}function ku(){var o,u,w,b,f,nt,n,k;if(_ge("panoDiv")||(r=s("panoDiv"),e.appendChild(r),ht=_anim.fadeE(r,gi)),o=_ge("hp_ctrls"),o&&!_ge("panoControls")){var h=s("panoLeft"),c=s("panoRight"),a=s("panoUp"),v=s("panoDown"),y=s("panoZoomIn"),p=s("panoZoomOut"),i=s("panoPosition");i.appendChild(a);i.appendChild(h);i.appendChild(c);i.appendChild(v);u=s("panoControlSet");u.appendChild(p);u.appendChild(i);u.appendChild(y);w=s("panoControls");w.appendChild(u);b=[h,c,a,v,y,p];function t(n,t){Pano.SetCameraFidelity(!1);ti=!1;d(n,t)}function d(n,t){ti==!1?(Pano.MovePano(n,t),sb_st(sj_wf(d,n,t),25)):Pano.SetCameraFidelity(!0)}function g(n){ti=!0;var t=sj_et(n);r&&t.id!="sh_ppl"&&t.id!="sh_pps"&&Pano.StopAnimation()}for(f=0,nt=b.length;f<nt;f++)sj_be(b[f],wi,g);sj_be(_d,wi,g);sj_be(y,l,sj_wf(t,"z",1));sj_be(p,l,sj_wf(t,"z",-1));sj_be(_w,gr,function(){r&&Pano.StopAnimation()});n=.05;k=_G&&_G.RTL===!0;sj_be(h,l,sj_wf(t,"x",k?-n:n));sj_be(c,l,sj_wf(t,"x",k?n:-n));sj_be(a,l,sj_wf(t,"y",n));sj_be(v,l,sj_wf(t,"y",-n));sj_be(_w,"blur",function(){r&&Pano.StopAnimation()});o.appendChild(w)}}function hi(n,t){function i(){ku();n.hs===!1&&w&&w.disable();var t=_w.location.search.indexOf("debug=1")!=-1,i="?h="+_w.location.host,u=sb_gt();Pano.InitializePano(n.url,r,function(){bu(n);_w.hp_llog&&hp_llog("Pano",sb_gt()-u)},t,n.pos,n.maxfov,i);sj_evt.fire("onPanoComplete")}_H.startTm&&t&&_w.hp_llog&&hp_llog("PanoStart",sb_gt()-_H.startTm);typeof Pano===c?(sj_evt.bind("onPanoLoad",function(){i()}),sj_jb("HomepagePano_c"),sj_be(_w,"resize",function(){r&&typeof Pano!==c&&typeof Pano.SetViewportSize===kr&&Pano.SetViewportSize(r.offsetWidth,r.offsetHeight)})):i()}function du(){ci(d)}function ci(n){sj_evt&&sj_evt.fire(ki,n)}function gu(){var e="DHPImpression",o="data-maximpression",t=_ge("dhp"),i,r,u,n,f;if(t&&t.hasAttribute(o)&&(i=parseInt(t.getAttribute(o)),_w.localStorage&&!isNaN(i)))try{if(r=localStorage.getItem(e),u=r!=null?parseInt(r):0,u<i)localStorage.setItem(e,u+1);else return!0}catch(s){HPL_er(s,"checkDHPCookie")}return(n=sj_cook&&sj_cook.get("_UR","D"),f=sj_cook&&sj_cook.get("_UR","DHP"),n&&n!="0"&&n!="1"||f&&f!="0")?!0:!1}function nf(){var t="isHomepage",i="http://"+_d.domain+"/",r=i.replace(/www\./i,""),n=tf();return n?ar(n,t,i)||ar(n,t,r):0}function ar(n,t,i){try{return n[t](i)}catch(r){return 0}}function tf(){var n=_ge("dhp_detect");return n||(n=sj_ce("span","dhp_detect"),n.style.behavior="url(#default#homepage)",sj_b.appendChild(n)),n}function vr(){if(gu()||nf())y&&(y.style.display=v),ui&&(ui.style.display=v);else if(ct&&y&&y.style.display!=v){var n=y.offsetLeft;(!lt||lt&&lt.clientWidth<rr)&&(n-=rr);y.style.visibility=n<ct.offsetLeft+ct.clientWidth?pi:g}}function yr(i){sj_pd(i);n==0&&t&&t.length==1?h(sj_wf(oi,i)):oi(i)}function pr(i){sj_pd(i);n==0&&t&&t.length==1?h(sj_wf(ei,i)):ei(i)}function h(n){sb_st(sj_wf(fr,n),1);sj_ue(i,it,h);sj_ue(f,it,h);sj_ue(i,d,h);sj_ue(f,d,h)}function wr(){ur(0,br,function(r){var e,c,l,s;if(r){if(n=0,ai!=null)for(ou(),e=0;e<rt;e++)t[e].fullstartdate==ai&&(n=e);else fi(0,0);k=k||u.tooltips;sj_be(i,nt,oi);sj_be(f,nt,ei);i.firstChild.style.visibility=g;f.firstChild.style.visibility=g;_H.hpkarrow&&sj_be(_d,bt,au);c=_ge("sh_pl");l=_ge("sh_ps");at();i.firstChild.className=t[n][nr]=="1"?et:ot;hp_enable(i);t[n].pano?hi(t[n].pano,!0):t[n].vid&&(s=t[n].vid.dark,c.parentNode.className=s?"sh_pll":"sh_pld",l.parentNode.className=s?"sh_psl":"sh_psd",i.firstChild.className=s?et:ot);iu&&(sj_be(i,bi,yr),sj_be(f,bi,pr));sj_be(i,it,h);sj_be(f,it,h);sj_be(i,d,h);sj_be(f,d,h);o&&hpWall&&(_G.Mkt=="zh-CN"?sj_be(o,nt,hpWall.dLFree):sj_be(o,nt,hpWall.dL))}})}var pt="pointer",wt="default",c="undefined",kr="function",g="visible",pi="hidden",dr="hp_pgps",d="focus",nt="click",bt="keydown",l="mousedown",wi="mouseup",it="mouseover",gr="mousewheel",bi="touchstart",ki="hpsbact",nu="div",di="block",v="none",kt=8,gi=500,rt=0,n=0,dt=0,p=null,gt=0,t=[],ut=[],ni=[],w,ft="url",nr="bot",e=_ge("bgDiv"),tu=_ge("bgDivPortrait"),i=_ge("sh_igl"),f=_ge("sh_igr"),o=_ge("sh_igw"),b=0,a=_ge("sh_cp"),et="sc_light",ot="sc_dark",tr="no_outline",st="javascript:void(0)",u=null,ti=!0,iu="ontouchstart"in _w,r=null,ii=null,uf=_ge("sbox"),tt=_ge("sb_form_q"),ir=tt&&tt.parentNode,k,ri=_anim.fadeE(e,gi),ht,ct=_ge("sc_hdu"),y=_ge("dhp"),ui=_ge("dhplink"),lt=_ge("id_h"),rr=300,ru=fu(),vt,vi,yi,yt;if(i&&f&&(_w.hp_overrideImg=function(n,t){ni[n]=t},uu(),_w.hpPanoLoad=function(n){hi(n,!0)},!_w.g_IMVL)){typeof _w.g_IMVL!==c&&(_w.g_IMVL=1);sj_evt.bind("onHPHS",function(n){w=n[1]},1);vt=_ge("vid");vt&&!_H.forceAudio&&(vt.muted=!0,vt.volume=0);tt&&(sj_be(tt,d,du),sj_be(tt,bt,ci),ir&&sj_be(ir,nt,ci));ct&&(y||ui)&&lt&&(sj_evt.bind("dhplink",vr,1),sj_be(_w,"resize",vr,!1));var rf=new RegExp("[\\?&]ssd=([^&#]*)"),li=rf.exec(_w.location.href),br=1,ai;if(li!=null&&li[1]!=null&&(ai=li[1].replace("_",""),br=kt),vi=!0,_w.QuickSettings)for(yi=_w.QuickSettings.getActiveSettings(),yt=0;yt<yi.length;++yt)yi[yt].name==="DisableIOTD"&&(vi=!1);vi?(wr(),sj_evt.bind("onRBComplete",function(){var n=_w.sched;_w.g_hptse&&n&&n.schedule({ns:"H",task:function(){n.complete("H")}});su()},1)):_H.initIV=wr}};sj_evt.bind("onBgSet",ImgViewer,1)